% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/McDisCov.R
\name{McDisCov}
\alias{McDisCov}
\title{McDisCov: Outcome-linked Microbiome Discovery via Compositional lOgit-normal modeling under Varying support}
\usage{
library(McDisCov)
McDisCov(
  taxa_data,
  meta_data,
  variables,
  imputation = FALSE,
  zero_impute = 0.5,
  zero_ratio_threshold = 1,
  alpha = 0.05,
  Wc = 0.7,
  nonzero_cut = 3,
  lib_cut = 0,
  cov_shrinkage = "diag",
  lambda_seq = seq(0, 1, by = 0.1)
)
}
\arguments{
\item{taxa_data}{A data frame or matrix representing the observed count table.
Rows correspond to samples and columns correspond to taxa.}

\item{meta_data}{A data frame of covariates. The rows of \code{meta_data} correspond
to the rows of \code{taxa_data}.}

\item{variables}{A character vector containing covariates of interest and potential
confounders. For example, \code{variables = c("bin", "cont")}. Note that grouping
variables should be converted into factors.}

\item{imputation}{Logical; \code{TRUE} or \code{FALSE}. Default is \code{FALSE}.}

\item{selected_taxa}{Integer indices of reference taxa to always keep or impute;
default is \code{NULL} (automatic selection).}

\item{zero_ratio_threshold}{A real number in the interval \eqn{[0,1]}. Default is \code{1}.
When \code{imputation = TRUE}, taxa are sorted by zero proportion, and those with zero ratios
less than or equal to \code{zero_ratio_threshold} will be imputed with \code{zero_impute}.}

\item{zero_impute}{A positive real value. Default is \code{0.5}. If
\code{imputation = TRUE}, zeros are replaced with this pseudo-count.}

\item{Wc}{A real value between 0 and 1; the cutoff used to identify taxa with weak and
strong associations. Default is \code{0.7}.}

\item{alpha}{A real value between 0 and 1; the significance level for differential
relative abundance tests. Default is \code{0.05}.}

\item{nonzero_cut}{A non-negative integer. Taxa with more than \code{nonzero_cut}
nonzero observations per group are kept (a continuous variable is treated as one group).
Default is \code{3}.}

\item{lib_cut}{A non-negative real value. After taxa filtering, samples with total read counts
greater than \code{lib_cut} are retained. Default is \code{0}.}

\item{cov_shrinkage}{Character string specifying the shrinkage target for covariance estimation.
Default is \code{"diag"}. Options include \code{"diag"}, \code{"mean"}, and \code{"identity"}.
See the paper for more details.}

\item{lambda_seq}{A numeric vector specifying the shrinkage strengths to be tested.
Default is \code{seq(0, 1, by = 0.1)}.}
}
\value{
A list with the following components:
\itemize{
\item \code{taxa_data}: The taxa table used for analysis.
\item \code{meta_data}: The metadata used for analysis.
\item \code{AA}: A named list (one element per tested variable). Each element is a data frame with columns:
\describe{
\item{Taxa}{Taxon name.}
\item{effect_size}{Estimated log-scale effect size with respect to absolute abundance.}
\item{W}{Total number of significant pairwise differences for that taxon.}
\item{DA_group}{Association strength per taxon: \code{0 = not}, \code{1 = weak}, \code{2 = strong}.}
}
\item \code{RA}: A named list (one element per tested variable). Each element is a data frame with columns:
\describe{
\item{Taxa}{Taxon name.}
\item{Estimate}{Per-taxon log-scale effect size estimate relative to the selected reference taxa.}
\item{StdError}{Standard error of the estimate.}
\item{TestStatistic}{Chi-squared test statistic with 1 degree of freedom.}
\item{p_val}{P-value.}
\item{DA}{Differential-abundance flag relative to the reference taxa: \code{0 = not associated}, \code{1 = associated}.}
}
\item \code{selected_taxa}: The automatically selected reference taxa.
\item \code{numerical_res}: A list containing numerical outputs:
\code{estimated_theta}, \code{estimated_sigma_c}, \code{theta_cov_matrix}, \code{pw_est}, and \code{pw_sig}.
}
}
\description{
The function identifies taxa whose absolute abundances (actual counts in a unit volume of an ecosystem)
and relative abundances (actual counts relative to the auto-selected reference taxa group) are associated
with the variable(s) of interest. It supports multiple continuous and categorical covariates for association
identification. For additional identification of arbitrarily weighted taxa groups (such as ALR, CLR, ILR,
and balance), refer to the function \code{gclr.test}.
}
\examples{
\dontrun{
set.seed(1)
Z <- matrix(rpois(100 * 20, 5), 100, 20)
meta <- data.frame(group = factor(sample(c("A", "B"), 100, TRUE)))
res <- McDisCov(Z, meta, variables = "group")
str(res$AA$group)
}

}
\author{
Jiahao Wang (\email{10225000478@stu.ecnu.edu.cn})
}
